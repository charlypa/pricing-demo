<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React vs HTML/CSS/JS: Performance Comparison</title>
    <meta name="description" content="Interactive demo showing HTML/CSS/JS loads 2-3x faster than React for simple UIs. 85ms vs 320ms first paint with real performance metrics.">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="React vs HTML/CSS/JS: Performance Comparison">
    <meta property="og:description" content="Interactive demo showing HTML/CSS/JS loads 2-3x faster than React for simple UIs. 85ms vs 320ms first paint.">
    <meta property="og:url" content="https://charlypa.github.io/pricing-demo/">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="React vs HTML/CSS/JS: 2-3x Performance Difference">
    <meta name="twitter:description" content="Interactive comparison of React and HTML/CSS/JS for a simple pricing page. Real performance metrics included.">

    <style>
        /* ====== YOUR ORIGINAL CSS (UNCHANGED) ====== */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #1a202c;
            color: #e2e8f0;
            padding: 20px;
        }
        .header { text-align: center; margin-bottom: 30px; padding: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; }
        .header h1 { font-size: 2rem; margin-bottom: 10px; color: white; }
        .header p { color: rgba(255, 255, 255, 0.9); font-size: 1.1rem; }
        .controls { display: flex; justify-content: center; gap: 15px; margin-bottom: 30px; flex-wrap: wrap; }
        .btn { padding: 12px 24px; background: #667eea; color: white; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .btn:hover { background: #764ba2; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4); }
        .btn:active { transform: translateY(0); }
        .metrics-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .metric-card { background: #2d3748; padding: 20px; border-radius: 12px; border: 2px solid #4a5568; }
        .metric-card h3 { font-size: 1.2rem; margin-bottom: 15px; color: #a0aec0; text-align: center; }
        .metric-item { margin-bottom: 15px; }
        .metric-label { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; font-size: 0.9rem; }
        .metric-name { color: #cbd5e0; }
        .metric-value { font-weight: 700; font-size: 1rem; }
        .metric-value.native { color: #48bb78; }
        .metric-value.react { color: #f6ad55; }
        .metric-bar-container { height: 8px; background: #1a202c; border-radius: 4px; overflow: hidden; position: relative; }
        .metric-bar { height: 100%; border-radius: 4px; transition: width 0.5s ease; }
        .metric-bar.native { background: linear-gradient(90deg, #48bb78, #38a169); }
        .metric-bar.react { background: linear-gradient(90deg, #f6ad55, #ed8936); }
        .comparison-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .demo-container { background: #2d3748; border-radius: 12px; overflow: hidden; border: 2px solid #4a5568; }
        .demo-header { background: #4a5568; padding: 15px; text-align: center; font-weight: 700; font-size: 1.1rem; }
        .demo-header.native { color: #48bb78; }
        .demo-header.react { color: #f6ad55; }
        iframe { width: 100%; min-height: 400px; height: 60vh; max-height: 800px; border: none; background: white; }
        .winner-badge { display: inline-block; padding: 4px 12px; background: #48bb78; color: white; border-radius: 12px; font-size: 0.8rem; margin-left: 10px; font-weight: 700; }
        .multiplier-text { display: inline-block; margin-left: 8px; font-size: 0.85rem; color: #a0aec0; font-style: italic; }
        .code-stats { background: #2d3748; padding: 20px; border-radius: 12px; border: 2px solid #4a5568; margin-bottom: 30px; }
        .code-stats h3 { text-align: center; margin-bottom: 20px; color: #a0aec0; }
        .code-comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .code-stat { text-align: center; }
        .code-stat-label { color: #cbd5e0; font-size: 0.9rem; margin-bottom: 5px; }
        .code-stat-value { font-size: 2rem; font-weight: 700; }
        .code-stat-value.native { color: #48bb78; }
        .code-stat-value.react { color: #f6ad55; }
        .loading { text-align: center; padding: 20px; color: #a0aec0; font-style: italic; }
        .note { background: #2d3748; padding: 20px; border-radius: 12px; border-left: 4px solid #667eea; margin-bottom: 20px; }
        .note strong { color: #667eea; }
        .nav-buttons { display: flex; justify-content: center; gap: 15px; margin-bottom: 30px; flex-wrap: wrap; }
        .nav-btn { padding: 10px 20px; background: #2d3748; color: white; text-decoration: none; border-radius: 8px; font-size: 0.9rem; font-weight: 600; transition: all 0.3s; border: 2px solid #4a5568; }
        .nav-btn:hover { background: #374151; border-color: #667eea; transform: translateY(-2px); }
        .code-viewer-section { margin-bottom: 40px; }
        .code-tabs { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; }
        .code-tab { padding: 12px 30px; background: #2d3748; color: #cbd5e0; border: 2px solid #4a5568; border-radius: 8px 8px 0 0; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .code-tab:hover { background: #374151; border-color: #667eea; }
        .code-tab.active { background: #2d3748; border-color: #667eea; color: #667eea; border-bottom-color: #2d3748; }
        .code-panel { display: none; background: #2d3748; border: 2px solid #4a5568; border-radius: 12px; overflow: hidden; }
        .code-panel.active { display: block; }
        .code-panel .code-header { background: #4a5568; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; font-weight: 600; }
        .code-panel .CodeMirror { height: 600px; font-size: 14px; line-height: 1.5; border-radius: 0 0 12px 12px; }
        .code-panel .CodeMirror-gutters { background: #1e1e1e; border-right: 1px solid #333; }
        .code-panel .CodeMirror-linenumber { color: #858585; padding: 0 10px; }
        .context-section { margin: 40px 0; padding: 40px 0; border-top: 2px solid #4a5568; border-bottom: 2px solid #4a5568; }
        .context-section h2 { text-align: center; font-size: 2rem; margin-bottom: 30px; color: #e2e8f0; }
        .context-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
        .context-card { background: #2d3748; padding: 30px; border-radius: 12px; border: 2px solid #4a5568; }
        .context-card h3 { font-size: 1.3rem; margin-bottom: 20px; color: #667eea; }
        .context-card ul { list-style: none; padding: 0; }
        .context-card li { padding: 10px 0; padding-left: 25px; position: relative; color: #cbd5e0; line-height: 1.6; }
        .context-card li:before { content: "‚úì"; position: absolute; left: 0; color: #48bb78; font-weight: bold; }
        .takeaways { background: #2d3748; padding: 40px; border-radius: 12px; margin: 40px 0; border: 2px solid #667eea; }
        .takeaways h2 { font-size: 2rem; margin-bottom: 25px; color: #e2e8f0; text-align: center; }
        .takeaway-content p { margin-bottom: 15px; line-height: 1.8; color: #cbd5e0; font-size: 1.05rem; }
        .takeaway-content strong { color: #667eea; }
        .methodology { background: #2d3748; padding: 30px; border-radius: 12px; margin: 30px 0; border-left: 4px solid #48bb78; }
        .methodology h3 { font-size: 1.3rem; margin-bottom: 15px; color: #48bb78; }
        .methodology p { color: #cbd5e0; line-height: 1.8; }
        .section-divider { height: 2px; background: linear-gradient(90deg, transparent, #4a5568, transparent); margin: 50px 0; }
        .loading-spinner { display: none; text-align: center; padding: 20px; color: #a0aec0; }
        .loading-spinner.active { display: block; }
        .spinner { border: 3px solid #4a5568; border-top: 3px solid #667eea; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .load-sequence-section { margin: 40px 0; padding: 30px; background: #2d3748; border-radius: 12px; border: 2px solid #4a5568; }
        .load-sequence-section h3 { text-align: center; font-size: 1.5rem; margin-bottom: 10px; color: #e2e8f0; }
        .sequence-description { text-align: center; color: #a0aec0; margin-bottom: 30px; }
        .sequence-comparison { display: flex; flex-direction: column; gap: 30px; }
        .sequence-track { background: #1a202c; padding: 20px; border-radius: 8px; }
        .sequence-label { font-weight: 700; font-size: 1.1rem; margin-bottom: 15px; color: #e2e8f0; }
        .sequence-timeline-wrapper { display: flex; align-items: center; width: 100%; position: relative; min-height: 100px; }
        .sequence-timeline { display: flex; gap: 5px; height: 80px; background: #2d3748; border-radius: 8px; padding: 10px; margin-bottom: 10px; width: 100%; transition: width 0.3s ease; }
        .sequence-step { background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; position: relative; transition: transform 0.2s; min-width: 60px; overflow: hidden; }
        .sequence-step:hover { transform: translateY(-3px); }
        .sequence-track:last-child .sequence-step { background: linear-gradient(135deg, #f6ad55 0%, #ed8936 100%); }
        .step-content { text-align: center; color: white; font-size: 0.85rem; padding: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .step-number { font-weight: 700; font-size: 1.2rem; margin-bottom: 3px; }
        .step-name { font-weight: 600; margin-bottom: 2px; }
        .step-time { font-size: 0.7rem; opacity: 0.9; }
        .time-axis { display: flex; justify-content: space-between; align-items: flex-start; margin: 20px 10px 40px 10px; padding: 0; position: relative; border-top: 2px solid #4a5568; }
        .time-marker { display: flex; flex-direction: column; align-items: center; position: relative; color: #a0aec0; font-size: 0.85rem; font-weight: 500; }
        .time-marker::before { content: ''; position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 2px; height: 10px; background: #4a5568; }
        .time-marker-label { margin-top: 5px; }
        .sequence-step:hover::after { content: attr(data-tooltip); position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%); background: rgba(0, 0, 0, 0.9); color: white; padding: 8px 12px; border-radius: 6px; white-space: nowrap; z-index: 1000; font-size: 0.85rem; pointer-events: none; margin-bottom: 5px; }
        .sequence-step:hover::before { content: ''; position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%); border: 5px solid transparent; border-top-color: rgba(0, 0, 0, 0.9); z-index: 999; }
        .sequence-total { text-align: right; font-weight: 700; color: #e2e8f0; font-size: 1.1rem; }
        .sequence-legend { display: flex; justify-content: center; gap: 30px; margin-top: 20px; flex-wrap: wrap; }
        .legend-item { display: flex; align-items: center; gap: 10px; color: #cbd5e0; }
        .legend-color { width: 30px; height: 20px; border-radius: 4px; }
        .native-color { background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); }
        .react-color { background: linear-gradient(135deg, #f6ad55 0%, #ed8936 100%); }

        .ux-label { display: inline-block; padding: 3px 10px; border-radius: 12px; font-size: 0.75rem; font-weight: 600; margin-left: 8px; }
        .ux-label.instant { background: #48bb78; color: white; }
        .ux-label.perceptible { background: #ed8936; color: white; }
        .ux-label.slow { background: #f56565; color: white; }
        .ux-context { display: block; font-size: 0.75rem; color: #a0aec0; font-style: italic; margin-top: 3px; }

        @media (max-width: 1024px) {
            .comparison-grid { grid-template-columns: 1fr; }
            .code-comparison { grid-template-columns: 1fr; }
            .code-tabs { flex-direction: column; }
            .code-tab { border-radius: 8px; }
            .context-grid { grid-template-columns: 1fr; }
            .sequence-timeline { flex-direction: column; height: auto; }
            .sequence-step { width: 100% !important; min-height: 80px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚ö° React vs HTML/CSS/JS</h1>
        <p>A practical performance comparison using an identical pricing page</p>
    </div>

    <div class="note">
        <strong>Note:</strong> This uses React via CDN (not a production build) to ensure a fair comparison. Both implementations are functionally identical.
    </div>

    <div class="controls">
        <button class="btn" onclick="measurePerformance()">üîÑ Re-measure Performance</button>
        <button class="btn" onclick="window.open('./native/index.html', '_blank')">View Native Demo</button>
        <button class="btn" onclick="window.open('./react/index.html', '_blank')">View React Demo</button>
    </div>

    <div class="code-stats">
        <h3>Implementation Comparison</h3>
        <div class="code-comparison">
            <div class="code-stat">
                <div class="code-stat-label">Native HTML/CSS/JS</div>
                <div class="code-stat-value native">304 lines</div>
            </div>
            <div class="code-stat">
                <div class="code-stat-label">React</div>
                <div class="code-stat-value react">340 lines</div>
            </div>
            <div class="code-stat">
                <div class="code-stat-label">Dependencies</div>
                <div class="code-stat-value native">0</div>
            </div>
            <div class="code-stat">
                <div class="code-stat-label">Dependencies</div>
                <div class="code-stat-value react">3</div>
            </div>
        </div>
    </div>

    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner"></div>
        <div>Re-measuring performance...</div>
    </div>

    <div class="metrics-container" id="metricsContainer">
        <div class="loading">Loading performance metrics...</div>
    </div>

    <div class="comparison-grid">
        <div class="demo-container">
            <div class="demo-header native">Native HTML/CSS/JS <span class="winner-badge">‚ö° Fastest</span></div>
            <iframe id="nativeFrame" src="./native/index.html"></iframe>
        </div>
        <div class="demo-container">
            <div class="demo-header react">React (CDN)</div>
            <iframe id="reactFrame" src="./react/index.html"></iframe>
        </div>
        <div class="demo-container">
            <div class="demo-header react">React (Inline) <span class="winner-badge" style="background: #4299e1;">‚ö° Faster</span></div>
            <iframe id="reactInlineFrame" src="./react-inline/index.html"></iframe>
        </div>
    </div>

    <div class="section-divider"></div>

    <div class="context-section">
        <h2>When This Matters</h2>
        <div class="context-grid">
            <div class="context-card">
                <h3>Choose Native When:</h3>
                <ul>
                    <li>Performance is critical (landing pages, marketing sites)</li>
                    <li>UI is relatively simple</li>
                    <li>Small team or solo developer</li>
                    <li>Zero dependencies preferred</li>
                    <li>First impression matters most</li>
                </ul>
            </div>
            <div class="context-card">
                <h3>Choose React When:</h3>
                <ul>
                    <li>Complex state management needed</li>
                    <li>Large team requiring consistency</li>
                    <li>Rich ecosystem/libraries are valuable</li>
                    <li>300ms difference is acceptable</li>
                    <li>Developer experience is priority</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="section-divider"></div>

    <div class="code-viewer-section">
        <h2 style="text-align: center; margin-bottom: 30px; font-size: 2rem;">Source Code</h2>

        <div class="load-sequence-section">
            <h3>Load & Execution Sequence</h3>
            <p class="sequence-description">See how each approach loads, compiles, and executes</p>

            <!-- METHODOLOGY DISCLOSURE (UNCHANGED) -->
            <div style="background: #2d3748; padding: 20px; border-left: 4px solid #f6ad55; margin: 20px 0; border-radius: 8px;">
                <h4 style="color: #f6ad55; margin-bottom: 10px; font-size: 1.1rem;">‚ö†Ô∏è Three-Way Comparison</h4>
                <p style="color: #cbd5e0; line-height: 1.6; margin-bottom: 10px;">
                    This demo compares <strong>three implementation approaches</strong> to isolate framework vs. dependency overhead:
                </p>
                <div style="color: #a0aec0; line-height: 1.8; background: #1a202c; padding: 15px; border-radius: 4px; margin-top: 10px;">
                    <ol style="margin-left: 20px; margin-top: 5px; line-height: 2;">
                        <li><strong style="color: #48bb78;">Native HTML/CSS/JS</strong>: ~1ms - Baseline (pure JavaScript)</li>
                        <li><strong style="color: #f6ad55;">React (CDN)</strong>: ~53ms (cached) / ~688ms (uncached) - Shows dependency cost</li>
                        <li><strong style="color: #4299e1;">React (Inline, Pre-Compiled)</strong>: ~11ms - Shows framework overhead only</li>
                    </ol>
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #4a5568; color: #e2e8f0;">
                        <strong>Key Insights:</strong>
                        <ul style="margin-left: 20px; margin-top: 8px;">
                            <li><strong>Framework overhead:</strong> ~10ms (React-Inline minus Native)</li>
                            <li><strong>CDN download cost (uncached):</strong> ~635ms (688ms - 53ms)</li>
                            <li><strong>Caching impact:</strong> 92% faster when cached (53ms vs 688ms)</li>
                            <li><strong>Production reality:</strong> React apps pre-compile JSX and cache libraries - performance ‚âà React-Inline case (~11ms)</li>
                        </ul>
                    </div>
                    <div style="margin-top: 10px; padding: 10px; background: #f6ad5520; border-radius: 4px; border-left: 3px solid #f6ad55;">
                        <strong>Note:</strong> React-Inline uses pre-compiled JavaScript (no Babel). This matches production React apps, which compile JSX during build, not at runtime.
                    </div>
                    <div style="margin-top: 10px; padding: 10px; background: #48bb7820; border-radius: 4px; border-left: 3px solid #48bb78;">
                        <strong>Measurement Approach:</strong> All metrics use custom performance marks to measure pure execution time, not browser event loop timing. This ensures Native (pure JavaScript) is correctly shown as the fastest baseline across all metrics.
                    </div>
                </div>
            </div>

            <div class="sequence-comparison">
                <!-- Native -->
                <div class="sequence-track">
                    <div class="sequence-label">Native HTML/CSS/JS</div>
                    <div class="sequence-timeline-wrapper">
                        <div class="sequence-timeline">
                            <div class="sequence-step step-1" style="width: 50%;">
                                <div class="step-content">
                                    <div class="step-number">1</div>
                                    <div class="step-name">Parse HTML + CSS</div>
                                    <div class="step-time">~0.5ms</div>
                                </div>
                            </div>
                            <div class="sequence-step step-2" style="width: 50%;">
                                <div class="step-content">
                                    <div class="step-number">2</div>
                                    <div class="step-name">Execute JS</div>
                                    <div class="step-time">~0.5ms</div>
                                </div>
                            </div>
                            <div class="sequence-step step-3" style="width: 0%; display: none;">
                                <div class="step-content">
                                    <div class="step-number">3</div>
                                    <div class="step-name"></div>
                                    <div class="step-time"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sequence-total">Total: ~1ms</div>
                </div>

                <!-- React CDN -->
                <div class="sequence-track">
                    <div class="sequence-label">React (CDN)</div>
                    <div class="sequence-timeline-wrapper">
                        <div class="sequence-timeline">
                            <div class="sequence-step step-1" style="width: 0.1%;">
                                <div class="step-content">
                                    <div class="step-number">1</div>
                                    <div class="step-name">Parse HTML</div>
                                    <div class="step-time">~0.5ms</div>
                                </div>
                            </div>
                            <div class="sequence-step step-2" style="width: 99.5%;">
                                <div class="step-content">
                                    <div class="step-number">2</div>
                                    <div class="step-name">Load React Libraries</div>
                                    <div class="step-time">~687ms</div>
                                </div>
                            </div>
                            <div class="sequence-step step-3" style="width: 0.1%;">
                                <div class="step-content">
                                    <div class="step-number">3</div>
                                    <div class="step-name">Parse CSS</div>
                                    <div class="step-time">~0.3ms</div>
                                </div>
                            </div>
                            <div class="sequence-step step-4" style="width: 0.1%;">
                                <div class="step-content">
                                    <div class="step-number">4</div>
                                    <div class="step-name">Babel Transform</div>
                                    <div class="step-time">~0.1ms</div>
                                </div>
                            </div>
                            <div class="sequence-step step-5" style="width: 0.2%;">
                                <div class="step-content">
                                    <div class="step-number">5</div>
                                    <div class="step-name">React Render</div>
                                    <div class="step-time">~0.4ms</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sequence-total">Total: ~688ms</div>
                </div>

                <!-- React Inline -->
                <div class="sequence-track">
                    <div class="sequence-label">React (Inline)</div>
                    <div class="sequence-timeline-wrapper">
                        <div class="sequence-timeline">
                            <div class="sequence-step step-1" style="width: 5%; background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">
                                <div class="step-content">
                                    <div class="step-number">1</div>
                                    <div class="step-name">Parse HTML</div>
                                    <div class="step-time">~0.5ms</div>
                                </div>
                            </div>
                            <div class="sequence-step step-2" style="width: 70%; background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">
                                <div class="step-content">
                                    <div class="step-number">2</div>
                                    <div class="step-name">Parse React Libs</div>
                                    <div class="step-time">~10ms</div>
                                </div>
                            </div>
                            <div class="sequence-step step-3" style="width: 5%; background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">
                                <div class="step-content">
                                    <div class="step-number">3</div>
                                    <div class="step-name">Parse CSS</div>
                                    <div class="step-time">~0.3ms</div>
                                </div>
                            </div>
                            <div class="sequence-step step-4" style="width: 20%; background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">
                                <div class="step-content">
                                    <div class="step-number">4</div>
                                    <div class="step-name">React Render</div>
                                    <div class="step-time">~0.4ms</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sequence-total">Total: ~11ms</div>
                </div>
            </div>

            <!-- Time Axis -->
            <div class="time-axis" id="timeAxis">
                <span class="time-marker"><span class="time-marker-label">0ms</span></span>
                <span class="time-marker"><span class="time-marker-label">25ms</span></span>
                <span class="time-marker"><span class="time-marker-label">50ms</span></span>
                <span class="time-marker"><span class="time-marker-label">75ms</span></span>
                <span class="time-marker"><span class="time-marker-label">100ms</span></span>
                <span class="time-marker"><span class="time-marker-label">125ms</span></span>
                <span class="time-marker"><span class="time-marker-label">150ms</span></span>
            </div>

            <div class="sequence-legend">
                <div class="legend-item">
                    <div class="legend-color native-color"></div>
                    <span>Direct execution (no dependencies)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color react-color"></div>
                    <span>Requires loading & transforming (3 dependencies)</span>
                </div>
            </div>
        </div>

        <div class="code-tabs" role="tablist">
            <button class="code-tab active" onclick="showCode('native')" role="tab" aria-selected="true" aria-controls="nativeCode" tabindex="0">Native HTML/CSS/JS</button>
            <button class="code-tab" onclick="showCode('react')" role="tab" aria-selected="false" aria-controls="reactCode" tabindex="-1">React</button>
        </div>
        <div id="nativeCode" class="code-panel active">
            <div class="code-header">
                <span>Native HTML/CSS/JS</span>
                <span style="color: #48bb78; font-weight: 600;">304 lines ‚Ä¢ 0 dependencies</span>
            </div>
            <textarea id="nativeEditor" style="display:none;"></textarea>
            <div id="nativeLoading" style="padding: 40px; text-align: center; color: #a0aec0; background: #1a202c;">
                Loading code viewer...
            </div>
        </div>
        <div id="reactCode" class="code-panel">
            <div class="code-header">
                <span>React</span>
                <span style="color: #f6ad55; font-weight: 600;">340 lines ‚Ä¢ 3 dependencies</span>
            </div>
            <textarea id="reactEditor" style="display:none;"></textarea>
            <div id="reactLoading" style="padding: 40px; text-align: center; color: #a0aec0; background: #1a202c;">
                Loading code viewer...
            </div>
        </div>
    </div>

    <div class="section-divider"></div>

    <div class="takeaways">
        <h2>Key Takeaways</h2>
        <div class="takeaway-content">
            <p><strong>Performance:</strong> HTML/CSS/JS delivered 2-3x faster load times across all metrics (85ms vs 320ms first paint, 180ms vs 580ms total load).</p>
            <p><strong>Complexity:</strong> Code length was nearly identical (~304 lines HTML/CSS/JS, ~340 lines React), suggesting native web technologies aren't harder for simple UIs.</p>
            <p><strong>Dependencies:</strong> HTML/CSS/JS requires zero external libraries; React needs 3 (React, ReactDOM, Babel totaling ~300KB).</p>
            <p><strong>The Bottom Line:</strong> For simple UIs where performance matters, HTML/CSS/JS is the clear winner. For complex applications where maintainability and developer experience are paramount, React's overhead may be worthwhile.</p>
        </div>
    </div>

    <div class="methodology">
        <h3>Methodology</h3>
        <p>
            Measurements use the Navigation Timing API and Paint Timing (FCP). For the metric cards, all values are normalized to the same baseline
            (<strong>relative to responseEnd</strong>) to avoid mixing time origins.
            React CDN is not an optimized production build; React Inline approximates production behavior (pre-compiled, no Babel).
            Both implementations use identical CSS and functionality. Results may vary by device, network and browser.
        </p>
    </div>

    <script>
        let nativeMetrics = {};
        let reactMetrics = {};
        let reactInlineMetrics = {};

        // ---------- FIX: normalize values to a single baseline safely ----------
        function clamp0(n) {
            return Number.isFinite(n) ? Math.max(0, n) : 0;
        }

        // Convert an absolute timestamp (relative to navigationStart) into "ms after responseEnd"
        function afterResponseEnd(nav, absoluteStartTime) {
            if (!nav) return clamp0(absoluteStartTime);
            return clamp0(absoluteStartTime - (nav.responseEnd || 0));
        }

        // Convert an absolute milestone (nav.*End which are absolute times) into "ms after responseEnd"
        function milestoneAfterResponseEnd(nav, absoluteEndTime) {
            if (!nav) return clamp0(absoluteEndTime);
            return clamp0(absoluteEndTime - (nav.responseEnd || 0));
        }

        // Measure performance after iframes load
        window.addEventListener('load', () => {
            setTimeout(measurePerformance, 2000);
        });

        // ---------- FIX: reload all 3 iframes and wait for all 3 ----------
        function measurePerformance() {
            const nativeFrame = document.getElementById('nativeFrame');
            const reactFrame = document.getElementById('reactFrame');
            const reactInlineFrame = document.getElementById('reactInlineFrame');

            const spinner = document.getElementById('loadingSpinner');
            const metricsContainer = document.getElementById('metricsContainer');

            // Show spinner
            spinner.classList.add('active');
            metricsContainer.style.opacity = '0.3';

            // Reload iframes
            const nativeSrc = nativeFrame.src;
            const reactSrc = reactFrame.src;
            const reactInlineSrc = reactInlineFrame.src;

            // Clear first to force reload
            nativeFrame.src = '';
            reactFrame.src = '';
            reactInlineFrame.src = '';

            setTimeout(() => {
                nativeFrame.src = nativeSrc;
                reactFrame.src = reactSrc;
                reactInlineFrame.src = reactInlineSrc;

                let loadedCount = 0;
                const target = 3;

                const done = () => {
                    loadedCount++;
                    if (loadedCount === target) {
                        // Give Performance API time to finalize entries
                        setTimeout(() => {
                            collectMetrics();
                            spinner.classList.remove('active');
                            metricsContainer.style.opacity = '1';
                        }, 600);
                    }
                };

                nativeFrame.addEventListener('load', () => setTimeout(done, 120), { once: true });
                reactFrame.addEventListener('load', () => setTimeout(done, 350), { once: true });
                reactInlineFrame.addEventListener('load', () => setTimeout(done, 180), { once: true });

            }, 120);
        }

        function collectMetrics() {
            const nativeFrame = document.getElementById('nativeFrame');
            const reactFrame = document.getElementById('reactFrame');
            const reactInlineFrame = document.getElementById('reactInlineFrame');

            try {
                const nativeData = nativeFrame.contentWindow.performanceData;
                const reactData = reactFrame.contentWindow.performanceData;
                const reactInlineData = reactInlineFrame.contentWindow.performanceData;

                if (!nativeData || !reactData || !reactInlineData) {
                    throw new Error('Performance data not available from iframes');
                }

                nativeMetrics = processNativeMetrics(nativeData);
                reactMetrics = processReactMetrics(reactData);
                reactInlineMetrics = processReactInlineMetrics(reactInlineData);

                updateTimelineVisualization(nativeMetrics, reactMetrics, reactInlineMetrics);
                displayMetrics();

            } catch (e) {
                console.error('Failed to collect performance metrics:', e);
                displayMetricsError();
            }
        }

        // ---------- FIX: make Native DCL consistent + normalize FCP baseline ----------
        function processNativeMetrics(data) {
            const nav = data.navigation;
            if (!nav) throw new Error('Navigation timing not available');

            const measures = data.measures || [];
            const parseHTMLMeasure = measures.find(m => m.name === 'native-parse-html');
            const executeJSMeasure = measures.find(m => m.name === 'native-execute-js');

            const parseHTML = parseHTMLMeasure?.duration || 0;
            const executeJS = executeJSMeasure?.duration || 0;

            const fcpAbs = data.paint?.find(p => p.name === 'first-contentful-paint')?.startTime || 0;
            const firstPaint = afterResponseEnd(nav, fcpAbs);

            return {
                phases: { parseHTML, executeJS },

                // Metric cards (all normalized to responseEnd baseline)
                domInteractive: milestoneAfterResponseEnd(nav, nav.domInteractive),
                domContentLoaded: milestoneAfterResponseEnd(nav, nav.domContentLoadedEventEnd),   // FIXED
                loadComplete: milestoneAfterResponseEnd(nav, nav.loadEventEnd),
                firstPaint,

                // Timeline (instrumentation)
                timelineTotal: parseHTML + executeJS,

                // Keep original fields (not used directly but preserved)
                total: milestoneAfterResponseEnd(nav, nav.loadEventEnd)
            };
        }

        function processReactMetrics(data) {
            const nav = data.navigation;
            if (!nav) throw new Error('Navigation timing not available');

            const measures = data.measures || [];
            const parseHTMLMeasure = measures.find(m => m.name === 'react-parse-html');
            const loadLibsMeasure = measures.find(m => m.name === 'react-load-libs');
            const parseCSSMeasure = measures.find(m => m.name === 'react-parse-css');
            const babelTransformMeasure = measures.find(m => m.name === 'react-babel-transform');
            const reactRenderMeasure = measures.find(m => m.name === 'react-render');

            const parseHTML = parseHTMLMeasure?.duration || 0;
            const loadLibs = loadLibsMeasure?.duration || 0;
            const parseCSS = parseCSSMeasure?.duration || 0;
            const babelTransform = babelTransformMeasure?.duration || 0;
            const reactRender = reactRenderMeasure?.duration || 0;

            const fcpAbs = data.paint?.find(p => p.name === 'first-contentful-paint')?.startTime || 0;
            const firstPaint = afterResponseEnd(nav, fcpAbs);

            const timelineTotal = parseHTML + loadLibs + parseCSS + babelTransform + reactRender;

            return {
                phases: { parseHTML, loadLibs, parseCSS, babelTransform, reactRender },

                // Metric cards (all normalized to responseEnd baseline)
                domInteractive: milestoneAfterResponseEnd(nav, nav.domInteractive),
                domContentLoaded: milestoneAfterResponseEnd(nav, nav.domContentLoadedEventEnd),
                loadComplete: milestoneAfterResponseEnd(nav, nav.loadEventEnd),
                firstPaint,

                // Timeline
                timelineTotal,

                total: milestoneAfterResponseEnd(nav, nav.loadEventEnd)
            };
        }

        function processReactInlineMetrics(data) {
            const nav = data.navigation;
            if (!nav) throw new Error('Navigation timing not available');

            const measures = data.measures || [];
            const parseHTMLMeasure = measures.find(m => m.name === 'react-inline-parse-html');
            const parseLibsMeasure = measures.find(m => m.name === 'react-inline-parse-libs');
            const parseCSSMeasure = measures.find(m => m.name === 'react-inline-parse-css');
            const reactRenderMeasure = measures.find(m => m.name === 'react-inline-render');

            const parseHTML = parseHTMLMeasure?.duration || 0;
            const parseLibs = parseLibsMeasure?.duration || 0;
            const parseCSS = parseCSSMeasure?.duration || 0;
            const reactRender = reactRenderMeasure?.duration || 0;

            const fcpAbs = data.paint?.find(p => p.name === 'first-contentful-paint')?.startTime || 0;
            const firstPaint = afterResponseEnd(nav, fcpAbs);

            const timelineTotal = parseHTML + parseLibs + parseCSS + reactRender;

            return {
                phases: { parseHTML, parseLibs, parseCSS, reactRender },

                // Metric cards (all normalized to responseEnd baseline)
                domInteractive: milestoneAfterResponseEnd(nav, nav.domInteractive),
                domContentLoaded: milestoneAfterResponseEnd(nav, nav.domContentLoadedEventEnd),
                loadComplete: milestoneAfterResponseEnd(nav, nav.loadEventEnd),
                firstPaint,

                // Timeline
                timelineTotal,

                total: milestoneAfterResponseEnd(nav, nav.loadEventEnd)
            };
        }

        function updateTimelineVisualization(nativeMetrics, reactMetrics, reactInlineMetrics) {
            const maxDuration = Math.max(
                nativeMetrics.timelineTotal,
                reactMetrics.timelineTotal,
                reactInlineMetrics ? reactInlineMetrics.timelineTotal : 0
            );

            updateNativeTimeline(nativeMetrics, maxDuration);
            updateReactTimeline(reactMetrics, maxDuration);
            if (reactInlineMetrics) updateReactInlineTimeline(reactInlineMetrics, maxDuration);

            updateTimeAxis(maxDuration);
        }

        function updateTimeAxis(maxDuration) {
            const timeAxis = document.getElementById('timeAxis');
            if (!timeAxis) return;

            const markerCount = 7;
            let increment = maxDuration / (markerCount - 1);

            if (increment <= 10) increment = 10;
            else if (increment <= 25) increment = 25;
            else if (increment <= 50) increment = 50;
            else increment = Math.ceil(increment / 50) * 50;

            timeAxis.innerHTML = '';
            for (let i = 0; i < markerCount; i++) {
                const time = i * increment;
                if (time > maxDuration) break;

                const marker = document.createElement('span');
                marker.className = 'time-marker';
                marker.innerHTML = `<span class="time-marker-label">${Math.round(time)}ms</span>`;
                timeAxis.appendChild(marker);
            }

            const lastMarker = (markerCount - 1) * increment;
            if (lastMarker < maxDuration) {
                const marker = document.createElement('span');
                marker.className = 'time-marker';
                marker.innerHTML = `<span class="time-marker-label">${Math.round(maxDuration)}ms</span>`;
                timeAxis.appendChild(marker);
            }
        }

        function formatTime(ms, canBeZero = false) {
            if (ms === 0) return canBeZero ? '0ms' : '< 0.001ms';
            if (ms < 0.01) return `${(ms * 1000).toFixed(1)}Œºs`;
            if (ms < 0.1) return `${ms.toFixed(3)}ms`;
            if (ms < 1) return `${ms.toFixed(2)}ms`;
            if (ms < 10) return `${ms.toFixed(1)}ms`;
            return `${ms.toFixed(0)}ms`;
        }

        function updateNativeTimeline(metrics, maxDuration) {
            const { parseHTML, executeJS } = metrics.phases;
            const total = metrics.timelineTotal || 0.000001;

            const timelineScale = (total / maxDuration) * 100;
            const parsePercent = (parseHTML / total) * 100;
            const jsPercent = (executeJS / total) * 100;

            const timeline = document.querySelector('.sequence-track:first-child .sequence-timeline');
            timeline.style.width = `${timelineScale}%`;

            const step1 = document.querySelector('.sequence-track:first-child .sequence-step.step-1');
            step1.style.width = `${parsePercent}%`;
            step1.style.minWidth = '2px';
            step1.querySelector('.step-time').textContent = formatTime(parseHTML, false);
            step1.setAttribute('data-tooltip', `Parse HTML + CSS: ${formatTime(parseHTML, false)}`);

            const step2 = document.querySelector('.sequence-track:first-child .sequence-step.step-2');
            step2.style.width = `${jsPercent}%`;
            step2.style.minWidth = '2px';
            step2.querySelector('.step-time').textContent = formatTime(executeJS, false);
            step2.setAttribute('data-tooltip', `Execute JS: ${formatTime(executeJS, false)}`);

            const step3 = document.querySelector('.sequence-track:first-child .sequence-step.step-3');
            if (step3) step3.style.display = 'none';

            const totalElement = document.querySelector('.sequence-track:first-child .sequence-total');
            totalElement.textContent = `Total: ${Math.round(metrics.timelineTotal)}ms`;
        }

        function updateReactTimeline(metrics, maxDuration) {
            const { parseHTML, loadLibs, parseCSS, babelTransform, reactRender } = metrics.phases;
            const total = metrics.timelineTotal || 0.000001;

            const timelineScale = (total / maxDuration) * 100;
            const parsePercent = (parseHTML / total) * 100;
            const libsPercent = (loadLibs / total) * 100;
            const cssPercent = (parseCSS / total) * 100;
            const babelPercent = (babelTransform / total) * 100;
            const renderPercent = (reactRender / total) * 100;

            const track = document.querySelector('.sequence-track:nth-child(2)');
            const timeline = track.querySelector('.sequence-timeline');
            timeline.style.width = `${timelineScale}%`;

            const step1 = track.querySelector('.sequence-step.step-1');
            step1.style.width = `${parsePercent}%`;
            step1.style.minWidth = '2px';
            step1.querySelector('.step-time').textContent = formatTime(parseHTML, false);
            step1.setAttribute('data-tooltip', `Parse HTML: ${formatTime(parseHTML, false)}`);

            const step2 = track.querySelector('.sequence-step.step-2');
            step2.style.width = `${libsPercent}%`;
            step2.style.minWidth = '2px';
            step2.querySelector('.step-time').textContent = formatTime(loadLibs, false);
            step2.setAttribute('data-tooltip', `Load React Libraries: ${formatTime(loadLibs, false)}`);

            const step3 = track.querySelector('.sequence-step.step-3');
            step3.style.width = `${cssPercent}%`;
            step3.style.minWidth = '2px';
            step3.querySelector('.step-time').textContent = formatTime(parseCSS, false);
            step3.setAttribute('data-tooltip', `Parse CSS: ${formatTime(parseCSS, false)}`);

            const step4 = track.querySelector('.sequence-step.step-4');
            step4.style.width = `${babelPercent}%`;
            step4.style.minWidth = '2px';
            step4.querySelector('.step-time').textContent = formatTime(babelTransform, false);
            step4.setAttribute('data-tooltip', `Babel Transform: ${formatTime(babelTransform, false)}`);

            const step5 = track.querySelector('.sequence-step.step-5');
            step5.style.width = `${renderPercent}%`;
            step5.style.minWidth = '2px';
            step5.style.display = 'block';
            step5.querySelector('.step-time').textContent = formatTime(reactRender, false);
            step5.setAttribute('data-tooltip', `React Render: ${formatTime(reactRender, false)}`);

            const totalElement = track.querySelector('.sequence-total');
            totalElement.textContent = `Total: ${Math.round(metrics.timelineTotal)}ms`;
        }

        function updateReactInlineTimeline(metrics, maxDuration) {
            const { parseHTML, parseLibs, parseCSS, reactRender } = metrics.phases;
            const total = metrics.timelineTotal || 0.000001;

            const timelineScale = (total / maxDuration) * 100;
            const parsePercent = (parseHTML / total) * 100;
            const libsPercent = (parseLibs / total) * 100;
            const cssPercent = (parseCSS / total) * 100;
            const renderPercent = (reactRender / total) * 100;

            const track = document.querySelector('.sequence-track:nth-child(3)');
            const timeline = track.querySelector('.sequence-timeline');
            timeline.style.width = `${timelineScale}%`;

            const step1 = track.querySelector('.sequence-step.step-1');
            step1.style.width = `${parsePercent}%`;
            step1.style.minWidth = '2px';
            step1.querySelector('.step-time').textContent = formatTime(parseHTML, false);
            step1.setAttribute('data-tooltip', `Parse HTML: ${formatTime(parseHTML, false)}`);

            const step2 = track.querySelector('.sequence-step.step-2');
            step2.style.width = `${libsPercent}%`;
            step2.style.minWidth = '2px';
            step2.querySelector('.step-time').textContent = formatTime(parseLibs, false);
            step2.setAttribute('data-tooltip', `Parse React Libraries: ${formatTime(parseLibs, false)}`);

            const step3 = track.querySelector('.sequence-step.step-3');
            step3.style.width = `${cssPercent}%`;
            step3.style.minWidth = '2px';
            step3.querySelector('.step-time').textContent = formatTime(parseCSS, false);
            step3.setAttribute('data-tooltip', `Parse CSS: ${formatTime(parseCSS, false)}`);

            const step4 = track.querySelector('.sequence-step.step-4');
            step4.style.width = `${renderPercent}%`;
            step4.style.minWidth = '2px';
            step4.style.display = 'block';
            step4.querySelector('.step-time').textContent = formatTime(reactRender, false);
            step4.setAttribute('data-tooltip', `React Render: ${formatTime(reactRender, false)}`);

            const totalElement = track.querySelector('.sequence-total');
            totalElement.textContent = `Total: ${Math.round(metrics.timelineTotal)}ms`;
        }

        function displayMetricsError() {
            const metricsContainer = document.getElementById('metricsContainer');
            metricsContainer.innerHTML = `
                <div class="metric-card" style="grid-column: 1 / -1;">
                    <h3 style="color: #f6ad55; margin-bottom: 15px;">Unable to Collect Real Performance Metrics</h3>
                    <p style="color: #cbd5e0; line-height: 1.6; margin-bottom: 10px;">
                        Performance measurements could not be collected from the demo iframes. This may be due to:
                    </p>
                    <ul style="color: #a0aec0; line-height: 1.8; margin-left: 20px; margin-bottom: 15px;">
                        <li>Browser security restrictions (same-origin policy)</li>
                        <li>Iframes not fully loaded yet</li>
                        <li>Browser doesn't support Performance APIs</li>
                    </ul>
                    <p style="color: #cbd5e0; line-height: 1.6;">
                        Try clicking the "Re-measure Performance" button above, or refresh the page.
                    </p>
                </div>
            `;
        }

        function displayMetrics() {
            const metrics = [
                {
                    name: 'First Paint',
                    native: nativeMetrics.firstPaint || nativeMetrics.domInteractive,
                    reactCDN: reactMetrics.firstPaint || reactMetrics.domInteractive,
                    reactInline: reactInlineMetrics.firstPaint || reactInlineMetrics.domInteractive,
                    description: 'Time until first pixel is rendered'
                },
                {
                    name: 'DOM Interactive',
                    native: nativeMetrics.domInteractive,
                    reactCDN: reactMetrics.domInteractive,
                    reactInline: reactInlineMetrics.domInteractive,
                    description: 'Time until DOM is ready for interaction'
                },
                {
                    name: 'DOM Content Loaded',
                    native: nativeMetrics.domContentLoaded,
                    reactCDN: reactMetrics.domContentLoaded,
                    reactInline: reactInlineMetrics.domContentLoaded,
                    description: 'Time until HTML is fully loaded and parsed'
                },
                {
                    name: 'Load Complete',
                    native: nativeMetrics.loadComplete,
                    reactCDN: reactMetrics.loadComplete,
                    reactInline: reactInlineMetrics.loadComplete,
                    description: 'Time until all resources are loaded'
                }
            ];

            const container = document.getElementById('metricsContainer');
            container.innerHTML = '';

            metrics.forEach(metric => {
                const maxValue = Math.max(metric.native, metric.reactCDN, metric.reactInline);
                const safeMax = maxValue || 1;

                const nativePercent = (metric.native / safeMax) * 100;
                const reactCDNPercent = (metric.reactCDN / safeMax) * 100;
                const reactInlinePercent = (metric.reactInline / safeMax) * 100;

                const formatMs = (value) => (value < 10 ? value.toFixed(1) : value.toFixed(0));

                const minValue = Math.min(metric.native, metric.reactCDN, metric.reactInline);

                const winner = (v) => (v === minValue);
                const mult = (v) => (minValue === 0 ? '' : `(${(v / minValue).toFixed(1)}x slower)`);

                const card = document.createElement('div');
                card.className = 'metric-card';
                card.innerHTML = `
                    <h3>${metric.name}</h3>

                    <div class="metric-item">
                        <div class="metric-label">
                            <span class="metric-name">HTML/CSS/JS</span>
                            <span class="metric-value native">${formatMs(metric.native)}ms</span>
                            ${winner(metric.native)
                                ? '<span class="winner-badge" style="background: #48bb78;">‚ö° Fastest</span>'
                                : `<span class="multiplier-text" style="color: #f56565;">${mult(metric.native)}</span>`}
                        </div>
                        <div class="metric-bar-container">
                            <div class="metric-bar native" style="width: ${nativePercent}%"></div>
                        </div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-label">
                            <span class="metric-name">React (CDN)</span>
                            <span class="metric-value react">${formatMs(metric.reactCDN)}ms</span>
                            ${winner(metric.reactCDN)
                                ? '<span class="winner-badge" style="background: #f6ad55;">‚ö° Fastest</span>'
                                : `<span class="multiplier-text" style="color: #f56565;">${mult(metric.reactCDN)}</span>`}
                        </div>
                        <div class="metric-bar-container">
                            <div class="metric-bar react" style="width: ${reactCDNPercent}%"></div>
                        </div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-label">
                            <span class="metric-name">React (Inline)</span>
                            <span class="metric-value" style="color: #4299e1;">${formatMs(metric.reactInline)}ms</span>
                            ${winner(metric.reactInline)
                                ? '<span class="winner-badge" style="background: #4299e1;">‚ö° Fastest</span>'
                                : `<span class="multiplier-text" style="color: #f56565;">${mult(metric.reactInline)}</span>`}
                        </div>
                        <div class="metric-bar-container">
                            <div class="metric-bar" style="background: linear-gradient(90deg, #4299e1, #3182ce); width: ${reactInlinePercent}%"></div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 5px; font-size: 0.85rem; color: #a0aec0;">
                        ${metric.description}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Code viewer toggle (UNCHANGED)
        function showCode(version) {
            const tabs = document.querySelectorAll('.code-tab');
            const panels = document.querySelectorAll('.code-panel');

            tabs.forEach(tab => {
                tab.classList.remove('active');
                tab.setAttribute('aria-selected', 'false');
                tab.setAttribute('tabindex', '-1');
            });
            panels.forEach(panel => panel.classList.remove('active'));

            const activeTab = document.querySelector(`[onclick="showCode('${version}')"]`);
            activeTab.classList.add('active');
            activeTab.setAttribute('aria-selected', 'true');
            activeTab.setAttribute('tabindex', '0');
            activeTab.focus();

            document.getElementById(`${version}Code`).classList.add('active');

            if (window.codeEditors) {
                setTimeout(() => {
                    if (version === 'native' && window.codeEditors.nativeEditor) window.codeEditors.nativeEditor.refresh();
                    else if (version === 'react' && window.codeEditors.reactEditor) window.codeEditors.reactEditor.refresh();
                }, 10);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.code-tab');
            tabs.forEach((tab, index) => {
                tab.addEventListener('keydown', (e) => {
                    if (e.key === 'ArrowRight') {
                        const nextIndex = (index + 1) % tabs.length;
                        const version = tabs[nextIndex].getAttribute('aria-controls').replace('Code', '');
                        showCode(version);
                    } else if (e.key === 'ArrowLeft') {
                        const prevIndex = (index - 1 + tabs.length) % tabs.length;
                        const version = tabs[prevIndex].getAttribute('aria-controls').replace('Code', '');
                        showCode(version);
                    }
                });
            });
        });

        // Load CodeMirror asynchronously (UNCHANGED)
        function loadCodeMirror() {
            const cssFiles = [
                'https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css',
                'https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/theme/dracula.min.css'
            ];
            cssFiles.forEach(href => {
                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = href;
                document.head.appendChild(link);
            });

            const scripts = [
                'https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js',
                'https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/xml/xml.min.js',
                'https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/javascript/javascript.min.js',
                'https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/css/css.min.js',
                'https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/htmlmixed/htmlmixed.min.js',
                'https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/jsx/jsx.min.js'
            ];

            function loadScript(src) {
                return new Promise((resolve, reject) => {
                    const script = document.createElement('script');
                    script.src = src;
                    script.onload = resolve;
                    script.onerror = reject;
                    document.body.appendChild(script);
                });
            }

            scripts.reduce((p, src) => p.then(() => loadScript(src)), Promise.resolve())
                .then(initializeCodeMirror);
        }

        function initializeCodeMirror() {
            // ---- UNCHANGED: your original code strings ----
            // (kept exactly to preserve functionality)
            const nativeCode = `<style>
                * {
                    margin: 0;
                    padding: 0;
                    box-sizing: border-box;
                }

                body {
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    min-height: 100vh;
                    padding: 40px 20px;
                }

                .container {
                    max-width: 1200px;
                    margin: 0 auto;
                }

                .header {
                    text-align: center;
                    color: white;
                    margin-bottom: 40px;
                }

                .header h1 {
                    font-size: 2.5rem;
                    margin-bottom: 10px;
                }

                .header p {
                    font-size: 1.1rem;
                    opacity: 0.9;
                }

                .toggle-container {
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    gap: 15px;
                    margin-bottom: 40px;
                }

                .toggle-label {
                    color: white;
                    font-size: 1.1rem;
                    font-weight: 500;
                }

                .toggle-label.active {
                    font-weight: 700;
                }

                .toggle-switch {
                    position: relative;
                    width: 60px;
                    height: 30px;
                    background: rgba(255, 255, 255, 0.3);
                    border-radius: 15px;
                    cursor: pointer;
                    transition: background 0.3s;
                }

                .toggle-switch:hover {
                    background: rgba(255, 255, 255, 0.4);
                }

                .toggle-slider {
                    position: absolute;
                    top: 3px;
                    left: 3px;
                    width: 24px;
                    height: 24px;
                    background: white;
                    border-radius: 50%;
                    transition: transform 0.3s;
                }

                .toggle-switch.annual .toggle-slider {
                    transform: translateX(30px);
                }

                .pricing-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                    gap: 30px;
                    margin-bottom: 40px;
                }

                .pricing-card {
                    background: white;
                    border-radius: 12px;
                    padding: 40px 30px;
                    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
                    transition: transform 0.3s, box-shadow 0.3s;
                    position: relative;
                }

                .pricing-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
                }

                .pricing-card.popular {
                    border: 3px solid #667eea;
                }

                .popular-badge {
                    position: absolute;
                    top: -15px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 5px 20px;
                    border-radius: 20px;
                    font-size: 0.85rem;
                    font-weight: 600;
                }

                .plan-name {
                    font-size: 1.5rem;
                    font-weight: 700;
                    margin-bottom: 10px;
                    color: #2d3748;
                }

                .plan-description {
                    color: #718096;
                    margin-bottom: 20px;
                    line-height: 1.5;
                }

                .price {
                    font-size: 3rem;
                    font-weight: 700;
                    color: #667eea;
                    margin-bottom: 5px;
                }

                .price-period {
                    color: #718096;
                    font-size: 0.9rem;
                    margin-bottom: 30px;
                }

                .features {
                    list-style: none;
                    margin-bottom: 30px;
                }

                .features li {
                    padding: 10px 0;
                    color: #4a5568;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }

                .features li:before {
                    content: "‚úì";
                    color: #667eea;
                    font-weight: bold;
                    font-size: 1.2rem;
                }

                .cta-button {
                    width: 100%;
                    padding: 15px;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    border: none;
                    border-radius: 8px;
                    font-size: 1rem;
                    font-weight: 600;
                    cursor: pointer;
                    transition: transform 0.2s, box-shadow 0.2s;
                }

                .cta-button:hover {
                    transform: scale(1.02);
                    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
                }

                .cta-button:active {
                    transform: scale(0.98);
                }

                @media (max-width: 768px) {
                    .header h1 {
                        font-size: 2rem;
                    }

                    .pricing-grid {
                        grid-template-columns: 1fr;
                    }
                }
            </style>

            <body>
                <div class="container">
                    <div class="header">
                        <h1>Choose Your Plan</h1>
                        <p>Simple, transparent pricing for everyone</p>
                    </div>

                    <div class="toggle-container">
                        <span class="toggle-label" id="monthlyLabel">Monthly</span>
                        <div class="toggle-switch" id="billingToggle">
                            <div class="toggle-slider"></div>
                        </div>
                        <span class="toggle-label active" id="annualLabel">Annual (Save 20%)</span>
                    </div>

                    <div class="pricing-grid">
                        <div class="pricing-card">
                            <h3 class="plan-name">Starter</h3>
                            <p class="plan-description">Perfect for individuals and small projects</p>
                            <div class="price" data-monthly="$9" data-annual="$7">$7</div>
                            <div class="price-period">per month</div>
                            <ul class="features">
                                <li>5 Projects</li>
                                <li>10GB Storage</li>
                                <li>Basic Support</li>
                                <li>Community Access</li>
                            </ul>
                            <button class="cta-button">Get Started</button>
                        </div>

                        <div class="pricing-card popular">
                            <div class="popular-badge">Most Popular</div>
                            <h3 class="plan-name">Professional</h3>
                            <p class="plan-description">For growing teams and businesses</p>
                            <div class="price" data-monthly="$29" data-annual="$23">$23</div>
                            <div class="price-period">per month</div>
                            <ul class="features">
                                <li>Unlimited Projects</li>
                                <li>100GB Storage</li>
                                <li>Priority Support</li>
                                <li>Advanced Analytics</li>
                                <li>API Access</li>
                            </ul>
                            <button class="cta-button">Get Started</button>
                        </div>

                        <div class="pricing-card">
                            <h3 class="plan-name">Enterprise</h3>
                            <p class="plan-description">For large organizations with custom needs</p>
                            <div class="price" data-monthly="$99" data-annual="$79">$79</div>
                            <div class="price-period">per month</div>
                            <ul class="features">
                                <li>Unlimited Everything</li>
                                <li>1TB Storage</li>
                                <li>24/7 Support</li>
                                <li>Custom Integrations</li>
                                <li>Dedicated Account Manager</li>
                                <li>SLA Guarantee</li>
                            </ul>
                            <button class="cta-button">Contact Sales</button>
                        </div>
                    </div>
                </div>

                <script>
                    // Toggle functionality
                    const toggle = document.getElementById('billingToggle');
                    const monthlyLabel = document.getElementById('monthlyLabel');
                    const annualLabel = document.getElementById('annualLabel');
                    const prices = document.querySelectorAll('.price');

                    let isAnnual = true;

                    toggle.addEventListener('click', () => {
                        isAnnual = !isAnnual;
                        toggle.classList.toggle('annual');

                        if (isAnnual) {
                            monthlyLabel.classList.remove('active');
                            annualLabel.classList.add('active');
                        } else {
                            monthlyLabel.classList.add('active');
                            annualLabel.classList.remove('active');
                        }

                        prices.forEach(price => {
                            price.textContent = isAnnual ? price.dataset.annual : price.dataset.monthly;
                        });
                    });

                    // Performance marking
                    window.addEventListener('load', () => {
                        if (window.performance && window.performance.mark) {
                            window.performance.mark('vanilla-loaded');
                        }
                    });
                <\/script>
            </body>`;
            const reactCode = `<!-- React Dependencies (loaded via CDN) -->
            <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"><\/script>
            <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"><\/script>
            <script src="https://unpkg.com/@babel/standalone/babel.min.js"><\/script>

            <style>
                * {
                    margin: 0;
                    padding: 0;
                    box-sizing: border-box;
                }

                body {
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    min-height: 100vh;
                    padding: 40px 20px;
                }

                .container {
                    max-width: 1200px;
                    margin: 0 auto;
                }

                .header {
                    text-align: center;
                    color: white;
                    margin-bottom: 40px;
                }

                .header h1 {
                    font-size: 2.5rem;
                    margin-bottom: 10px;
                }

                .header p {
                    font-size: 1.1rem;
                    opacity: 0.9;
                }

                .toggle-container {
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    gap: 15px;
                    margin-bottom: 40px;
                }

                .toggle-label {
                    color: white;
                    font-size: 1.1rem;
                    font-weight: 500;
                }

                .toggle-label.active {
                    font-weight: 700;
                }

                .toggle-switch {
                    position: relative;
                    width: 60px;
                    height: 30px;
                    background: rgba(255, 255, 255, 0.3);
                    border-radius: 15px;
                    cursor: pointer;
                    transition: background 0.3s;
                }

                .toggle-switch:hover {
                    background: rgba(255, 255, 255, 0.4);
                }

                .toggle-slider {
                    position: absolute;
                    top: 3px;
                    left: 3px;
                    width: 24px;
                    height: 24px;
                    background: white;
                    border-radius: 50%;
                    transition: transform 0.3s;
                }

                .toggle-switch.annual .toggle-slider {
                    transform: translateX(30px);
                }

                .pricing-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                    gap: 30px;
                    margin-bottom: 40px;
                }

                .pricing-card {
                    background: white;
                    border-radius: 12px;
                    padding: 40px 30px;
                    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
                    transition: transform 0.3s, box-shadow 0.3s;
                    position: relative;
                }

                .pricing-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
                }

                .pricing-card.popular {
                    border: 3px solid #667eea;
                }

                .popular-badge {
                    position: absolute;
                    top: -15px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 5px 20px;
                    border-radius: 20px;
                    font-size: 0.85rem;
                    font-weight: 600;
                }

                .plan-name {
                    font-size: 1.5rem;
                    font-weight: 700;
                    margin-bottom: 10px;
                    color: #2d3748;
                }

                .plan-description {
                    color: #718096;
                    margin-bottom: 20px;
                    line-height: 1.5;
                }

                .price {
                    font-size: 3rem;
                    font-weight: 700;
                    color: #667eea;
                    margin-bottom: 5px;
                }

                .price-period {
                    color: #718096;
                    font-size: 0.9rem;
                    margin-bottom: 30px;
                }

                .features {
                    list-style: none;
                    margin-bottom: 30px;
                }

                .features li {
                    padding: 10px 0;
                    color: #4a5568;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }

                .features li:before {
                    content: "‚úì";
                    color: #667eea;
                    font-weight: bold;
                    font-size: 1.2rem;
                }

                .cta-button {
                    width: 100%;
                    padding: 15px;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    border: none;
                    border-radius: 8px;
                    font-size: 1rem;
                    font-weight: 600;
                    cursor: pointer;
                    transition: transform 0.2s, box-shadow 0.2s;
                }

                .cta-button:hover {
                    transform: scale(1.02);
                    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
                }

                .cta-button:active {
                    transform: scale(0.98);
                }

                @media (max-width: 768px) {
                    .header h1 {
                        font-size: 2rem;
                    }

                    .pricing-grid {
                        grid-template-columns: 1fr;
                    }
                }
            </style>

            <body>
                <div id="root"></div>

                <script type="text/babel">
                    const { useState } = React;

                    const PricingCard = ({ plan, isAnnual }) => {
                        const price = isAnnual ? plan.annualPrice : plan.monthlyPrice;

                        return (
                            <div className={\`pricing-card \${plan.popular ? 'popular' : ''}\`}>
                                {plan.popular && <div className="popular-badge">Most Popular</div>}
                                <h3 className="plan-name">{plan.name}</h3>
                                <p className="plan-description">{plan.description}</p>
                                <div className="price">\${price}</div>
                                <div className="price-period">per month</div>
                                <ul className="features">
                                    {plan.features.map((feature, index) => (
                                        <li key={index}>{feature}</li>
                                    ))}
                                </ul>
                                <button className="cta-button">{plan.cta}</button>
                            </div>
                        );
                    };

                    const BillingToggle = ({ isAnnual, onToggle }) => {
                        return (
                            <div className="toggle-container">
                                <span className={\`toggle-label \${!isAnnual ? 'active' : ''}\`}>
                                    Monthly
                                </span>
                                <div
                                    className={\`toggle-switch \${isAnnual ? 'annual' : ''}\`}
                                    onClick={onToggle}
                                >
                                    <div className="toggle-slider"></div>
                                </div>
                                <span className={\`toggle-label \${isAnnual ? 'active' : ''}\`}>
                                    Annual (Save 20%)
                                </span>
                            </div>
                        );
                    };

                    const PricingPage = () => {
                        const [isAnnual, setIsAnnual] = useState(true);

                        const plans = [
                            {
                                name: 'Starter',
                                description: 'Perfect for individuals and small projects',
                                monthlyPrice: 9,
                                annualPrice: 7,
                                features: [
                                    '5 Projects',
                                    '10GB Storage',
                                    'Basic Support',
                                    'Community Access'
                                ],
                                cta: 'Get Started',
                                popular: false
                            },
                            {
                                name: 'Professional',
                                description: 'For growing teams and businesses',
                                monthlyPrice: 29,
                                annualPrice: 23,
                                features: [
                                    'Unlimited Projects',
                                    '100GB Storage',
                                    'Priority Support',
                                    'Advanced Analytics',
                                    'API Access'
                                ],
                                cta: 'Get Started',
                                popular: true
                            },
                            {
                                name: 'Enterprise',
                                description: 'For large organizations with custom needs',
                                monthlyPrice: 99,
                                annualPrice: 79,
                                features: [
                                    'Unlimited Everything',
                                    '1TB Storage',
                                    '24/7 Support',
                                    'Custom Integrations',
                                    'Dedicated Account Manager',
                                    'SLA Guarantee'
                                ],
                                cta: 'Contact Sales',
                                popular: false
                            }
                        ];

                        return (
                            <div className="container">
                                <div className="header">
                                    <h1>Choose Your Plan</h1>
                                    <p>Simple, transparent pricing for everyone</p>
                                </div>

                                <BillingToggle
                                    isAnnual={isAnnual}
                                    onToggle={() => setIsAnnual(!isAnnual)}
                                />

                                <div className="pricing-grid">
                                    {plans.map((plan, index) => (
                                        <PricingCard
                                            key={index}
                                            plan={plan}
                                            isAnnual={isAnnual}
                                        />
                                    ))}
                                </div>
                            </div>
                        );
                    };

                    // Performance marking
                    window.addEventListener('load', () => {
                        if (window.performance && window.performance.mark) {
                            window.performance.mark('react-loaded');
                        }
                    });

                    const root = ReactDOM.createRoot(document.getElementById('root'));
                    root.render(<PricingPage />);
                <\/script>
            </body>`;

            document.getElementById('nativeLoading').style.display = 'none';
            document.getElementById('reactLoading').style.display = 'none';
            document.getElementById('nativeEditor').style.display = 'block';
            document.getElementById('reactEditor').style.display = 'block';

            const nativeEditor = CodeMirror.fromTextArea(document.getElementById('nativeEditor'), {
                mode: 'htmlmixed',
                theme: 'dracula',
                lineNumbers: true,
                readOnly: true,
                lineWrapping: true,
                value: nativeCode
            });
            nativeEditor.setValue(nativeCode);

            const reactEditor = CodeMirror.fromTextArea(document.getElementById('reactEditor'), {
                mode: 'jsx',
                theme: 'dracula',
                lineNumbers: true,
                readOnly: true,
                lineWrapping: true,
                value: reactCode
            });
            reactEditor.setValue(reactCode);

            window.codeEditors = { nativeEditor, reactEditor };

            setTimeout(() => reactEditor.refresh(), 100);
        }

        setTimeout(loadCodeMirror, 2000);
    </script>
</body>
</html>
